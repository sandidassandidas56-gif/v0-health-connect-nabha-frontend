"use strict";(()=>{var e={};e.id=696,e.ids=[696],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},47384:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>b,patchFetch:()=>j,requestAsyncStorage:()=>x,routeModule:()=>h,serverHooks:()=>y,staticGenerationAsyncStorage:()=>v});var s={};r.r(s),r.d(s,{GET:()=>g,POST:()=>f});var n=r(49303),o=r(88716),a=r(60670),i=r(87070),u=r(9487),c=r(11185),p=r.n(c);let d=new c.Schema({doctor:{type:String,required:!0},patient:{type:String,required:!0},date:{type:Date,required:!0},status:{type:String,required:!0}}),l=p().models.Consultation||p().model("Consultation",d);var m=r(51225);async function g(){let e=arguments[0],t=e.headers.get("authorization")?.replace("Bearer ",""),r=t?(0,m.W)(t):null;if(!r)return i.NextResponse.json({success:!1,message:"Unauthorized"},{status:401});if("admin"!==r.role&&"doctor"!==r.role)return i.NextResponse.json({success:!1,message:"Forbidden"},{status:403});await (0,u.v)();let s=await l.find().sort({date:-1}).limit(20);return i.NextResponse.json({consultations:s})}async function f(e){let t=e.headers.get("authorization")?.replace("Bearer ",""),r=t?(0,m.W)(t):null;if(!r)return i.NextResponse.json({success:!1,message:"Unauthorized"},{status:401});if("admin"!==r.role&&"doctor"!==r.role)return i.NextResponse.json({success:!1,message:"Forbidden"},{status:403});await (0,u.v)();let{doctor:s,patient:n,date:o,status:a}=await e.json();if(!s||!n||!o||!a)return i.NextResponse.json({success:!1,message:"Missing fields"},{status:400});let c=await l.create({doctor:s,patient:n,date:o,status:a});return i.NextResponse.json({success:!0,consultation:c})}let h=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/consultations/route",pathname:"/api/consultations",filename:"route",bundlePath:"app/api/consultations/route"},resolvedPagePath:"D:\\v0-health-connect-nabha-frontend\\frontend\\app\\api\\consultations\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:x,staticGenerationAsyncStorage:v,serverHooks:y}=h,b="/api/consultations/route";function j(){return(0,a.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:v})}},51225:(e,t,r)=>{r.d(t,{W:()=>i,f:()=>a});var s=r(41482),n=r.n(s);let o=process.env.JWT_SECRET||"supersecret";function a(e){return n().sign(e,o,{expiresIn:"7d"})}function i(e){try{return n().verify(e,o)}catch{return null}}},9487:(e,t,r)=>{r.d(t,{v:()=>a});var s=r(11185),n=r.n(s);let o=global.mongoose||{conn:null,promise:null};async function a(){return o.conn||(o.promise||(o.promise=n().connect("mongodb+srv://sandidassandidas56_db_user:jDadHJOKbzXGhdNM@cluster0.hnna6hc.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0",{bufferCommands:!1}).then(e=>e)),o.conn=await o.promise,global.mongoose=o),o.conn}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,972,482],()=>r(47384));module.exports=s})();